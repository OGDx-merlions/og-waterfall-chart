{"version":3,"sources":["og-waterfall-chart.es6.js"],"names":["Polymer","is","properties","data","type","Array","value","observer","floorValue","Number","ceilingValue","yAxisTicks","yTickInterval","yTickFormat","String","yAxisLabel","isChartBuilt","Boolean","readOnly","innerDimensions","Object","width","height","legends","label","color","barPadding","barMaxWidth","startingValue","listeners","barClick","d","i","fire","index","bubbles","ready","scopeSubtree","$","waterSVG","legendWrap","attached","length","draw","d3","Px","me","margin","top","right","bottom","left","isNaN","svg","select","attr","append","_setStartingValue","cumulative","forEach","isComputed","class","start","end","isStarting","name","ceilDiff","max","intervalMultiplier","Math","ceil","ceilAdd","ceiling","x","scaleBand","rangeRound","paddingInner","y","scaleLinear","range","clamp","domain","map","g","barWidth","bandwidth","xAxis","axisBottom","tickFormat","l","yAxis","axisLeft","ticks","tickValues","format","call","selectAll","_wrapText","tickSize","formatComma","bar","enter","on","bind","abs","text","filter","_addLegend","each","words","split","reverse","word","line","lineNumber","lineHeight","dy","parseFloat","tspan","pop","push","join","node","getComputedTextLength","legWrap","newData","oldData","dom","innerHTML"],"mappings":"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","file":"og-waterfall-chart.js","sourcesContent":["(function() {\n  Polymer({\n\n    is: 'og-waterfall-chart',\n\n    properties:{\n      data: {\n        type: Array,\n        value: [],\n        observer: '_dataChanged'\n      },\n      floorValue: {\n        type: Number,\n        value: 96000\n      },\n      ceilingValue: {\n        type: Number,\n        value: 0\n      },\n      yAxisTicks: {\n        type: Number,\n        value: 5\n      },\n      yTickInterval: {\n        type: Number,\n        value: 500\n      },\n      yTickFormat: {\n        type: String,\n        value: \"\"\n      },\n      yAxisLabel: {\n        type: String,\n        value: \"\" //LNG mass flow in kg/h\"\n      },\n      isChartBuilt: {\n        type: Boolean,\n        value: false,\n        readOnly: true\n      },\n      innerDimensions: {\n        type: Object,\n        readOnly: true,\n        value: {\n          width: 960,\n          height: 500\n        }\n      },\n      legends: {\n        type: Array,\n        value: [\n          { label: \"Increase\", color: \"#d43875\" },\n          { label: \"Decrease\", color: \"#e2913b\" },\n          { label: \"Total\", color: \"#5fbcf8\" }\n        ]\n      },\n      //chart appearance related properties\n      width: {\n        type: String,\n        value: \"100%\"\n      },\n      height: {\n        type: String,\n        value: \"300px\"\n      },\n      barPadding: {\n        type: Number,\n        value: 0.3\n      },\n      barMaxWidth: {\n        type: Number,\n        value: 50\n      },\n      startingValue: {\n        type: Number,\n        value: 0,\n        readOnly: true\n      },\n    },\n\n    listeners: {\n      'barClick': 'barClick'\n    },\n\n    barClick(d, i) {\n      this.fire('bar-click', {data: d, index: i}, {\n        bubbles: false\n      });\n    },\n\n    ready(){\n      this.scopeSubtree(this.$.waterSVG, true);\n      this.scopeSubtree(this.$.legendWrap, true);\n\n    },\n\n    attached(){\n      if(this.data && this.data.length)\n        this.draw();\n    },\n\n    draw(){\n      let d3 = Px.d3\n        , me = this\n        , data = this.data;\n\n      let margin = {top: 20, right: 20, bottom: 30, left: 50},\n\t\t\t\t\twidth = this.width - margin.left - margin.right,\n\t\t\t\t\theight = this.height - margin.top - margin.bottom;\n\n      if(isNaN(width) || isNaN(height))\n        return false;\n\n      let svg = d3.select(this.$.waterSVG)\n\t\t\t\t\t.attr(\"viewBox\", \"0 0 \"+this.width+\" \"+this.height)\n\t\t\t\t\t.attr(\"preserveAspectRatio\", \"xMidYMid meet\")\n\t\t\t\t.append(\"g\")\n\t\t\t\t\t.attr(\"transform\",\n\t\t\t\t\t\t\t\t\"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n      this._setStartingValue(data[0].value)\n\n      let cumulative = +this.startingValue;\n\n      //process data\n\t\t\tdata.forEach(function(d) {\n        if(d.isComputed){\n          d.class = 'total';\n          d.start = me.floorValue;\n          d.end = cumulative;\n        }\n        else{\n          d.start = (cumulative < me.floorValue) ? me.floorValue : cumulative;\n          d.class = (d.value<0) ? \"decrease\":\"increase\";\n        }\n\n        cumulative += d.value;\n\n        if(d.isStarting){\n          d.end = +me.startingValue;\n          d.start = me.floorValue;\n          d.class = 'total';\n          cumulative = +me.startingValue;\n        }\n        else{\n          if(!d.isComputed)\n            d.end = cumulative;\n        }\n\n        d.label = (d.label) ? d.label:d.name;\n\t\t\t});\n\n      //set ranges\n      let ceilDiff = +this.ceilingValue - d3.max(data, function(d) { return d.end; })\n        , intervalMultiplier = Math.ceil(ceilDiff / me.yTickInterval)\n        , ceilAdd = intervalMultiplier * me.yTickInterval\n        , ceiling = (+this.ceilingValue == 0) ? (d3.max(data, (d) => d.end ) + ((+me.ceilingValue == 0) ? me.yTickInterval : ceilAdd)) : (+this.ceilingValue + .001);\n        // , ceiling = (d3.max(data, (d) => d.end ) + ((+me.ceilingValue == 0) ? me.yTickInterval : ceilAdd));\n\n        // console.log(d3.max(data, (d) => { return d.end; }));\n      let x = d3.scaleBand().rangeRound([0, width]).paddingInner(0.05);\n\t\t\tlet y = d3.scaleLinear().range([height, 0]).clamp(true);\n\n      x.domain(data.map((d) => d.name ));\n      //y column domain, from 0 to the biggest end value\n      //if this chart is going to display negatives then it should use d3.min(data, function(d){ return d.start })\n      y.domain([me.floorValue, ceiling]);\n\n      svg.append(\"g\").attr(\"class\", \"container\");\n      let g = svg.select(\".container\");\n\n      //build axes\n      //to display the X axis on the chart\n      let barWidth = (x.bandwidth() > me.barMaxWidth) ? me.barMaxWidth : x.bandwidth();\n\n      let xAxis = d3.axisBottom(x).tickFormat((d) => {\n                //fetch the label field\n                //TODO: need to refactor this\n                for(var l=0; l<data.length; l++)\n                  if(data[l].name == d)\n                    return data[l].label;\n              });\n      let yAxis = d3.axisLeft(y).ticks(me.yAxisTicks).tickValues(d3.range(me.floorValue, ceiling, me.yTickInterval));\n\n      if(this.yTickFormat != \"\") {\n        yAxis.tickFormat(d3.format(this.yTickFormat));\n      }\n      else {\n        yAxis.tickFormat((d) => d);\n      }\n\n      g.append(\"g\")\n        .attr(\"class\", \"x axis\")\n        .attr(\"transform\", \"translate(-20,\" + (me.height - 50) + \")\")\n        .call(xAxis)\n        .selectAll(\"text\")\n        .attr(\"y\", 15)\n        .attr(\"x\", 0)\n        .attr(\"dy\", \".35em\")\n        .call(me._wrapText, barWidth);\n\n      //to display the Y axis on the chart\n      g.append(\"g\")\n          .attr(\"class\", \"y axis\")\n          .call(yAxis);\n      //this is for the grid\n      g.append(\"g\")\n        .attr(\"class\", \"grid\")\n        .call(yAxis\n            .tickSize(-me.width)\n            .tickFormat(\"\")\n        );\n\n      let formatComma = d3.format(\",\");\n      //\n      // //adding each bar from the data\n      // //this are the columns. the gaps between them are based on the x() function created above\n      let bar = g.selectAll(\".bar\")\n          .data(data)\n          .enter().append(\"g\")\n          .attr(\"class\", (d) => \"bar \" + d.class )\n          .attr(\"transform\", (d) => \"translate(\" + x(d.name) + \",0)\" )\n          .on(\"click\", me.barClick.bind(me));\n\n      //on each column we add the actual bars that will appear\n      //the position(\"y\") is based on either the start or end (whichever is bigger of the 2)\n      //the height of the bar is based on the difference of start and end (no negatives)\n      bar.append(\"rect\")\n          .attr(\"y\", (d) => y( Math.max(d.start, d.end) ) )\n          .attr(\"height\", (d) => { return Math.abs( y(d.start) - y(d.end) ); })\n          .attr(\"width\", barWidth)\n          .attr(\"class\", (d) => {\n              return (d.color) ? \"\":\"no-color\";\n          })\n          .attr(\"fill\", function(d) {\n            if(d.color)\n              return d.color;\n          });\n\n      // //this is text that appears on the bar\n      bar.append(\"text\")\n          .attr(\"x\", barWidth / 2)\n          .attr(\"y\", (d) => {\n            return (d.class==\"decrease\") ? y(d.end) : y(d.end) - 10;\n          })\n          .attr(\"dy\", (d) => { return ((d.class=='negative') ? '-' : '') + \".75em\" })\n          .text((d) => { return (d.class==\"total\") ? formatComma(d.end) : formatComma(d.end - d.start);});\n      //\n      bar.filter((d) => { return d.class != \"total\" }).append(\"line\")\n          .attr(\"class\", \"connector\")\n          .attr(\"x1\", barWidth )\n          .attr(\"y1\", function(d) { return y(d.end) } )\n          .attr(\"x2\", x.bandwidth() / ( 1 - me.barPadding) - 5 )\n          .attr(\"y2\", function(d) { return y(d.end) } )\n\n      me._addLegend();\n    },\n\n    barClick(d, i){\n      this.fire('bar-click', {data: d, index: i}, {\n        bubbles: false\n      });\n    },\n\n    _wrapText(text, width) {\n      text.each(function() {\n        var text = d3.select(this),\n            words = text.text().split(/\\s+/).reverse(),\n            word,\n            line = [],\n            lineNumber = 0,\n            lineHeight = 1.1, // ems\n            y = text.attr(\"y\"),\n            dy = parseFloat(text.attr(\"dy\")),\n            tspan = text.text(null).append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", dy + \"em\");\n        while (word = words.pop()) {\n          line.push(word);\n          tspan.text(line.join(\" \"));\n          if (tspan.node().getComputedTextLength() > width || tspan.node().getComputedTextLength() == 0) {\n            line.pop();\n            tspan.text(line.join(\" \"));\n            line = [word];\n            tspan = text.append(\"tspan\").attr(\"x\", 0).attr(\"y\", y).attr(\"dy\", ++lineNumber * lineHeight + dy + \"em\").text(word);\n          }\n        }\n      });\n    },\n\n    _addLegend(){\n      if(!this.legends || this.legends.length == 0)\n        return false;\n\n      for(let i=0; i<this.legends.length; i++){\n        let legWrap = d3.select(this.$.legendWrap)\n          .append(\"span\").attr(\"class\",\"legend-wrap\");\n\n        legWrap.append(\"span\").attr(\"class\",\"leg-text\")\n          .attr(\"style\", \"border-left: .3rem solid \"+this.legends[i].color)\n          .text(this.legends[i].label);\n      }\n    },\n\n    _dataChanged(newData, oldData){\n      if(newData && newData.length) {\n\t\t\t\tPolymer.dom(this.$.waterSVG).node.innerHTML = \"\";\n        Polymer.dom(this.$.legendWrap).node.innerHTML = \"\";\n\t\t\t\tthis.draw();\n\t\t\t}\n    }\n  });\n})();\n"]}